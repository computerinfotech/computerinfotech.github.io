<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>DAILY CASH LEDGER</title>
<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:Segoe UI, Arial;}
body,html{height:100%;background:#f5f5f5; overflow-x: hidden;}
button{cursor:pointer;}

/* --- LOGO 3D MOTION CSS WITH BG REMOVAL --- */
.moving-logo {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 180px; 
    height: auto;
    z-index: 5;
    animation: float3d 4s ease-in-out infinite;
    pointer-events: none;
    mix-blend-mode: multiply; 
}
.logo-left { left: 80px; }
.logo-right { right: 80px; }

@keyframes float3d {
    0% { transform: translateY(-50%) scale(1) perspective(1000px) translateZ(0); filter: drop-shadow(0 5px 15px rgba(0,0,0,0.3)); }
    50% { transform: translateY(-50%) scale(1.15) perspective(1000px) translateZ(50px); filter: drop-shadow(0 25px 35px rgba(0,0,0,0.5)); }
    100% { transform: translateY(-50%) scale(1) perspective(1000px) translateZ(0); filter: drop-shadow(0 5px 15px rgba(0,0,0,0.3)); }
}

@media (max-width: 1100px) { .moving-logo { display: none; } }

/* LOGIN OVERLAY */
#loginOverlay{
    position:fixed; inset:0;
    background:linear-gradient(135deg,#7b2ff7,#f107a3);
    display:flex; flex-direction: column;
    justify-content:center; align-items:center;
    z-index:1000;
}

/* TOP HEADINGS STYLE */
.top-heading-container { text-align: center; color: #ffffff; margin-bottom: 25px; z-index: 15; }
.top-heading-container h1 { font-size: 45px; font-weight: 900; margin: 0; letter-spacing: 2px; text-shadow: 2px 4px 8px rgba(0,0,0,0.3); }
.top-heading-container p { font-size: 18px; font-weight: 500; letter-spacing: 1.5px; margin-top: 5px; opacity: 0.9; }

.login-box{position: relative; background:rgba(255,255,255,0.1);padding:40px 30px;border-radius:20px;text-align:center;color:#fff;backdrop-filter:blur(10px);width:380px;border:2px solid rgba(255,255,255,0.2); z-index: 10; box-shadow: 0 15px 35px rgba(0,0,0,0.2);}
.login-box h2{margin-bottom:25px; font-size: 24px; border-bottom: 1px solid rgba(255,255,255,0.2); padding-bottom: 10px;}
.login-box input{width:100%;padding:14px;margin-bottom:20px;border-radius:8px;border:2px solid #fff;background:rgba(255,255,255,0.2);color:#fff;text-align:center; font-size: 17px; outline: none;}
.login-box input::placeholder { color: #ddd; }
.login-box button{width:100%;padding:15px;border:none;border-radius:8px;background:#ffeb3b;color:#000;font-weight:bold; font-size: 18px; transition: 0.3s;}
.login-box button:hover { background: #fdd835; transform: translateY(-2px); }
.login-error{color:#ff5252;margin-bottom:10px;display:none;text-shadow:0 0 4px #000; font-weight: bold;}

/* LEDGER & OTHER STYLES */
#ledger{display:none;max-width:1400px;margin:auto;padding:20px;background:#ffffffcc;border-radius:20px;box-shadow:0 20px 40px rgba(0,0,0,.25);position:relative;}
.header{text-align:center;background:linear-gradient(270deg,#ff00ff,#00ffff,#ff00ff);background-size:600% 600%;animation:gradient 8s ease infinite;padding:15px;border-radius:15px;color:#fff;}
.header h1{font-size:50px;margin:0;}
.header h2{font-size:18px;margin-top:5px;}
@keyframes gradient{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%;}}
.info-line{display:flex;justify-content:space-between;font-weight:bold;margin:15px 0;}
.style4{text-align:center;margin:20px auto;padding:8px;font-size:24px;font-weight:900;color:#0000ff;border-radius:12px;background:linear-gradient(135deg,#ff5722,#ff9800);box-shadow:0 6px 18px rgba(0,0,0,.35);}
.columns{display:flex;justify-content:center;gap:8px;}
.column{width:12%;}
table{width:100%;border-collapse:collapse;}
th,td{border:1px solid #999;padding:6px;text-align:center;}
th{background:#ffe066;}
input[type=text]{width:100%;border:none;outline:none;text-align:center;padding:6px;font-weight:bold;border-radius:4px;}
tfoot td{background:#ffd54f;font-weight:bold;font-size:18px;text-align:center;}
.result-btn{margin:25px auto;display:block;padding:14px 45px;font-size:18px;font-weight:bold;border:none;border-radius:40px;background:linear-gradient(90deg,#673ab7,#3f51b5);color:#fff;}
.blink{animation:blinkRed .8s infinite;border:2px solid red!important;}
@keyframes blinkRed{0%{box-shadow:0 0 0 red}50%{box-shadow:0 0 14px red}100%{box-shadow:0 0 0 red}}

.top-buttons{display:flex;justify-content:space-between;margin-bottom:15px;}
.top-buttons button{padding:10px 20px;border-radius:8px;border:none;font-weight:bold;color:#fff;transition:0.3s;}
.logout-btn{background:#c62828;}
.daily-record-btn{background:#2e7d32;}

.result-page{position:fixed; inset:0;background:#fffde7;display:flex;justify-content:center;align-items:center;z-index:99;opacity:0;transform:translateY(100%);transition:transform 2.5s ease,opacity 2.5s ease;}
.result-page.show{transform:translateY(0);opacity:1;}
.result-box{width:400px;background:#fff;padding:30px;border-radius:15px;box-shadow:0 20px 40px rgba(0,0,0,.35);text-align:left; animation:glow 2s ease infinite alternate;}
@keyframes glow{0%{box-shadow:0 0 20px rgba(103,58,183,0.5)}100%{box-shadow:0 0 40px rgba(103,58,183,1)}}
.slip-head{text-align:center;font-weight:900;font-size:22px}
.slip-sub{text-align:center;font-weight:bold;margin-bottom:12px}
.amount-line{margin:6px 0;font-weight:bold}
.result-text{font-size:18px;margin-top:15px;font-weight:bold}
.red{color:red} .blue{color:blue} .green{color:green}
.result-actions{text-align:center;margin-top:20px}
.result-actions button{padding:8px 20px;font-weight:bold;border:none;border-radius:6px;cursor:pointer;margin:0 6px;}
.print-btn{background:#2e7d32;color:#fff}
.back-btn{background:#c62828;color:#fff}
.save-btn{background:#673ab7;color:#fff;margin-top:15px;width:100%;padding:10px;border-radius:6px;cursor:pointer;font-weight:bold;}

#dailyRecordOverlay{position:fixed;inset:0;background:rgba(0,0,0,0.5);display:none;justify-content:center;align-items:center;z-index:999;}
.daily-record-box{background:#fff;padding:20px;border-radius:15px;width:700px;max-height:80%;overflow:auto;}
.loader-overlay{position:fixed;inset:0;background:rgba(255,255,255,0.9);display:none;justify-content:center;align-items:center;z-index:999;}
.loader{width:70px;height:70px;border:8px solid #ddd;border-top:8px solid #673ab7;border-radius:50%;animation:spin 1s linear infinite;}
@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}
.style5 {color: #FFFF00}
.style6 {font-size: 50px}
</style>
</head>
<body>

<div id="loginOverlay">
  <div class="top-heading-container">
      <h1 class="style6">COMPUTER INFOTECH</h1>
      <p>OLD G.T. ROAD BUDBUD, PURBA BARDHAMAN</p>
  </div>
  <div class="login-box">
    <h2>Admin Login</h2>
    <div class="login-error" id="loginError">Invalid Mobile Number!</div>
    <input type="text" id="adminMobile" placeholder="Admin Mobile No." maxlength="10">
    <button onClick="checkAdmin()">Login</button>
  </div>
</div>

<div id="ledger">
  <div class="top-buttons">
    <button class="logout-btn" onClick="logout()">Logout</button>
    <button class="daily-record-btn" onClick="showDailyRecord()">Daily Record</button>
  </div>

  <div class="header">
    <h1 class="style5">COMPUTER INFOTECH</h1>
    <h2 class="style5">OLD G.T. ROAD, BUDBUD, PURBA BARDHAMAN</h2>
  </div>

  <div class="info-line">
    <div>Date : <input type="text" id="today" style="width:120px;text-align:center;"></div>
    <div>Admin : <span id="adminName"></span></div>
  </div>

  <div class="style4">DAILY CASH LEDGER</div>

  <div class="columns">
    <div class="column"><table><th>Income</th><tbody id="income"></tbody></table></div>
    <div class="column"><table><th>Repair</th><tbody id="repair"></tbody></table></div>
    <div class="column"><table><th>NYCLD</th><tbody id="nycld"></tbody></table></div>
    <div class="column"><table><th>Opening</th><tbody id="opening"></tbody></table></div>
    <div class="column"><table><th>Withdraw</th><tbody id="withdraw"></tbody></table></div>
    <div class="column"><table><th>Transfer</th><tbody id="transfer"></tbody></table></div>
    <div class="column"><table><th>Commission</th><tbody id="commission"></tbody></table></div>
    <div class="column"><table><th>Old</th><tbody id="old"></tbody></table></div>
  </div>

  <table style="margin:20px auto;width:70%">
    <tfoot>
      <tr><td>Closing Balance (System)</td><td id="system">â‚¹ 0</td></tr>
      <tr><td>Closing Balance (Manual)</td><td><input type="text" id="manual" oninput="formatManual(this)" onFocus="manualFocus(this)"></td></tr>
    </tfoot>
  </table>

  <button class="result-btn" onClick="showResult()">RESULT</button>
</div>

<div class="result-page" id="resultPage">
  <div class="result-box">
    <div class="slip-head">COMPUTER INFOTECH</div>
    <div class="slip-sub">DAILY CASH RESULT</div>
    <div class="amount-line">Date : <span id="pDate"></span></div>
    <div class="amount-line">System Closing : <span id="pSys"></span></div>
    <div class="amount-line">Manual Closing : <span id="pMan"></span></div>
    <div class="amount-line">Admin : <span id="pAdmin"></span></div>
    <div class="result-text" id="pResult"></div>
    <div class="result-actions">
      <button class="print-btn" onClick="window.print()">ðŸ–¨ Print</button>
      <button class="back-btn" onClick="hideResult()">â¬… Back</button>
    </div>
    <button class="save-btn" onClick="saveRecord()">ðŸ’¾ Save Record</button>
  </div>
</div>

<div id="dailyRecordOverlay">
  <div class="daily-record-box">
    <h3>Daily Records</h3>
    <table id="dailyRecordsTable">
      <thead><tr><th>Date</th><th>System</th><th>Manual</th><th>Status</th><th>Admin</th><th>Action</th></tr></thead>
      <tbody></tbody>
    </table>
    <br>
    <button onClick="hideDailyRecord()">Close</button>
  </div>
</div>

<div class="loader-overlay" id="loader">
  <div class="loader"></div>
</div>

<script>
// Admins
const adminList = {
  "9932482798": "Sanjay Agarwal",
  "9563452015": "Rupesh Kr Mishra",
  "8972984498": "Joy Kr Chakraborty"
};
let currentAdmin="";

// Load records from localStorage
let dailyRecords = JSON.parse(localStorage.getItem("dailyRecords")) || [];

// Login
function showLoginError(msg){ const e=document.getElementById("loginError"); e.innerText=msg; e.style.display="block";}
function checkAdmin(){
  const mobile=document.getElementById("adminMobile").value.trim();
  if(mobile.length!==10){showLoginError("Mobile must be 10 digits!");return;}
  if(adminList[mobile]){
    currentAdmin=adminList[mobile];
    document.getElementById("adminName").innerText=currentAdmin;
    document.getElementById("loginOverlay").style.display="none";
    document.getElementById("ledger").style.display="block";
  }else showLoginError("You are not an admin of Computer Infotech!");
}
document.getElementById("adminMobile").addEventListener("keydown",e=>{if(e.key==="Enter")checkAdmin();});

// Set auto date
let todayInput=document.getElementById("today");
let d=new Date();
todayInput.value = String(d.getDate()).padStart(2,'0')+"-"+String(d.getMonth()+1).padStart(2,'0')+"-"+d.getFullYear();

// Undo & Ledger Inputs
let undoStack=[];
const cols=["income","repair","nycld","opening","withdraw","transfer","commission","old"];
cols.forEach(id=>addRow(id));
function addRow(id){
  let tr=document.createElement("tr");
  let td=document.createElement("td");
  let input=document.createElement("input");
  input.type="text"; input.placeholder="â‚¹";
  input.onfocus=function(){if(!this.value)this.value="â‚¹ ";};
  input.onkeydown=e=>{if(e.key==="Enter"){e.preventDefault(); let r=addRow(id); undoStack.push(r); setTimeout(()=>r.querySelector("input").focus(),10);}};
  input.oninput=function(){let v=this.value.replace(/[^\d]/g,''); this.value=v?"â‚¹ "+v:""; calculate();};
  td.appendChild(input); tr.appendChild(td); document.getElementById(id).appendChild(tr); return tr;
}
document.addEventListener("keydown",e=>{if(e.ctrlKey&&e.key.toLowerCase()==="z"){e.preventDefault(); if(undoStack.length){undoStack.pop().remove(); calculate();}}});

// Calculate system balance
function calculate(){
  let plus=0,minus=0;
  document.querySelectorAll("#income input,#repair input,#nycld input,#opening input,#transfer input,#commission input,#old input").forEach(i=>plus+=Number(i.value.replace(/[^\d]/g,''))||0);
  document.querySelectorAll("#withdraw input").forEach(i=>minus+=Number(i.value.replace(/[^\d]/g,''))||0);
  document.getElementById("system").innerText="â‚¹ "+(plus-minus);
}

// Manual Input formatting
function manualFocus(el){if(!el.value)el.value="â‚¹ "; }
function formatManual(el){let v=el.value.replace(/[^\d]/g,''); el.value=v?"â‚¹ "+v:""; if(v)el.classList.remove("blink");}

// Result
function showResult(){
  let manVal=Number(document.getElementById("manual").value.replace("â‚¹ ",""));
  if(!manVal){document.getElementById("manual").classList.add("blink");document.getElementById("manual").focus(); return;}
  document.getElementById("loader").style.display="flex";
  setTimeout(()=>{
    let sys=Number(document.getElementById("system").innerText.replace("â‚¹ ",""));
    let diff=manVal-sys;
    document.getElementById("pDate").innerText=document.getElementById("today").value;
    document.getElementById("pSys").innerText="â‚¹ "+sys;
    document.getElementById("pMan").innerText="â‚¹ "+manVal;
    document.getElementById("pAdmin").innerText=currentAdmin;
    let pResult=document.getElementById("pResult");
    pResult.className="result-text";
    if(diff===0){pResult.textContent="âœ” Perfect Balance";pResult.classList.add("green");}
    else if(diff>0){pResult.textContent="Increase / Extra : â‚¹ "+diff;pResult.classList.add("blue");}
    else{pResult.textContent="Decrease / Short : â‚¹ "+Math.abs(diff);pResult.classList.add("red");}
    document.getElementById("loader").style.display="none";
    document.getElementById("ledger").style.display="none";
    document.getElementById("resultPage").classList.add("show");
  },2500);
}
function hideResult(){document.getElementById("resultPage").classList.remove("show"); document.getElementById("ledger").style.display="block";}

// Save record persistently
function saveRecord(){
  let date=document.getElementById("today").value;
  let sys=document.getElementById("system").innerText;
  let man=document.getElementById("manual").value;
  let status=document.getElementById("pResult").textContent;
  dailyRecords.push({date,sys,man,status,admin:currentAdmin});
  localStorage.setItem("dailyRecords", JSON.stringify(dailyRecords));
  alert("Record Saved!");
}

// Daily record overlay
function showDailyRecord(){
  let tbody=document.querySelector("#dailyRecordsTable tbody"); tbody.innerHTML="";
  dailyRecords.forEach((r,i)=>{
    let tr=document.createElement("tr");
    tr.innerHTML=`<td>${r.date}</td><td>${r.sys}</td><td>${r.man}</td><td style="color:${r.status.includes("Extra")?"blue":r.status.includes("Short")?"red":"green"}">${r.status}</td><td>${r.admin}</td><td><button class="delete-btn" onclick="deleteRecord(${i})">Delete</button></td>`;
    tbody.appendChild(tr);
  });
  document.getElementById("dailyRecordOverlay").style.display="flex";
}
function hideDailyRecord(){document.getElementById("dailyRecordOverlay").style.display="none";}

// Delete manually
function deleteRecord(i){
  if(confirm("Are you sure you want to delete this record?")){
    dailyRecords.splice(i,1);
    localStorage.setItem("dailyRecords", JSON.stringify(dailyRecords));
    showDailyRecord();
  }
}

// Logout
function logout(){
  document.getElementById("ledger").style.display="none";
  document.getElementById("loginOverlay").style.display="flex";
  document.getElementById("adminMobile").value="";
}
</script>
</body>
</html>
